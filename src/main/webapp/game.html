<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="style/fontStyle.css">
<link rel="stylesheet" type="text/css" href="style/gameStyle.css">
<link rel="shortcut icon" href="img/icon.png">
<title>Battleship</title>
</head>
<script type="text/javascript" src="Plugin/jquery-1.11.3.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/jquery-ui.min.js" type="text/javascript"></script>
<script>
	
$(document).ready(function() {
	
	function swipeRight() 
	{
		jQuery('#left').animate({
				width:0,
				opacity:0
			},
			200
		);
		jQuery('#right').animate({
				width:'100%',
				'left': '=0%',
				opacity:1.0
			},
			400	
		);
		jQuery('#right').toggleClass('active',true);
		jQuery('#left').toggleClass('active',false);
		jQuery('#rightarrow').hide();
		jQuery('#leftarrow').show();
		
	};
	function swipeLeft()
	{

		jQuery('#right').animate({
				width:0,
				opacity:0
			},
			200
		);
		jQuery('#left').animate({
				width:'100%',
				'right': '=0%',
				opacity:1.0
			},
			400	
		);
		jQuery('#left').toggleClass('active',true);
		jQuery('#right').toggleClass('active',false);
		jQuery('#leftarrow').hide();
		jQuery('#rightarrow').show();
		
	};
	
	//Arrow management
	$('#rightarrow').on('click', function(e){
		swipeRight();
	});
	$('#leftarrow').on('click', function(e){
		swipeLeft();
	});
	//Keyboard navigation
	$("body").keydown(function( event ) {
  		if ( event.keyCode == 39 && $('#left').hasClass('active') ){
			swipeRight();		
  		}
		else if ( event.keyCode == 37 && $('#right').hasClass('active') ) {
			swipeLeft();		
  		}
	});
});

function allowDrop(ev) {
	var table = document.getElementById('tableleft');
	var tableZone = table.getBoundingClientRect();
    if ((ev.clientX > tableZone.left && ev.clientX < tableZone.right) && (ev.clientY < tableZone.bottom&& ev.clientY > tableZone.top)){ev.preventDefault();}
	else return false;
}

function drag(ev) {
	var style = window.getComputedStyle(ev.target, null);
    ev.dataTransfer.setData("text/plain",
	(ev.target.id) + ',' + 
	(parseInt(style.getPropertyValue("left"),10) - ev.clientX) + ',' + 
	(parseInt(style.getPropertyValue("top"),10) - ev.clientY));
		//ev.target = div
}

function drop(ev) {
    var offset = ev.dataTransfer.getData("text/plain").split(',');
    var dm = document.getElementById(offset[0]);
    dm.style.left = (ev.clientX + parseInt(offset[1],10)) + 'px';
    dm.style.top = (ev.clientY + parseInt(offset[2],10)) + 'px';
    ev.preventDefault();
    return false;
}


// HTML GENERATION
var gridx = 8, gridy = 8;
var Ships = [["Minesweeper",2,4],["Frigate",3,4],[ "Cruiser",4,2],[ "Battleship",5,1]];

var player1Grid = [[]];
var player2Grid = [[]];
var player1Ships = [];

document.write("<div id=\"animated-background\" ></div>");
document.write("<p id=\"phase\" > place your ships! </p>");

// player 1 table
document.write("<div id='left' class='active' ondrop='drop(event)' ondragover='allowDrop(event)'>");
document.write("<div id='shipdiv' ondrop='drop(event)' ondragover='allowDrop(event)'>");
document.write("<div class ='ship cruiser' id='ship1' draggable='true' ondragstart='drag(event)'/></div>");
document.write("<div class ='ship carrier' id='ship2' draggable='true' ondragstart='drag(event)'/></div>");
document.write("<div class ='ship battleship' id='ship3' draggable='true' ondragstart='drag(event)'/></div>");
document.write("<div class ='ship destroyer' id='ship4' draggable='true' ondragstart='drag(event)'></div>");
document.write("<div class ='ship submarine'id='ship5' draggable='true' ondragstart='drag(event)'></div>");
document.write("</div>");
document.write("<table id='tableleft'>");
for (i=0; i<gridx; i++)
{
	//rows
	document.write("<tr id='column" + i + "'>");
	player1Grid[i]=[];
	for (j=0; j<gridy; j++)
	{
		// cells
		document.write("<td id='row" + j + "'>");
		player1Grid[i][j]=j;
		document.write("</td>");
	}
	document.write("</tr>");
}
document.write("</table></div>");

// player 2 table
document.write("<div id='right'><table id='tableright'>");
for (i=0; i<gridx; i++)
{	
	//rows
	document.write("<tr>");
	player2Grid[i]=[];
	for (j=0; j<gridy; j++)
	{
		// cells
		document.write("<td>X");
		player2Grid[i][j]=j;
		document.write("</td>");
	}
	document.write("</tr>");
}

document.write("</table></div>");

document.write("<div id=\"rightarrow\">-></div>");
document.write("<div id=\"leftarrow\"><-</div>");


document.write("<form action=\"http://www.html.am/html-codes/forms/html-form-tag-action.cfm\" target=\"chattextarea\" method=\"get\" id=\"chat\">");
document.write("<div id=\"chatdiv\">");
document.write("<input id=\"chatinput\" name=\"chatinput\" type=\"text\" value=\"\" form=\"chat\">");
document.write("<input type=\"submit\" id=\"chatbutton\" value=\"Send\">");
document.write("</form>");
document.write("<div id=\"chattextarea\" name=\"chattextarea\"></div>");
document.write("</div>");
</script>
<body>
</body>
</html>
